<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TodoList</title>
    <link rel="stylesheet" type="text/css" href="./css/app.css"/>
    <link rel="stylesheet" type="text/css" href="./css/Header.css"/>
    <link rel="stylesheet" type="text/css" href="./css/editor.css"/>
    <link rel="stylesheet" type="text/css" href="./css/list.css"/>
    <link rel="stylesheet" type="text/css" href="./css/todoitem.css"/>
</head>
<body>
    <script>
        let mockData = [ 
      {id:0, isDone:false, content:"React study", date: new Date()}, 
      {id:1, isDone:true, content:"ÏπúÍµ¨ÎßåÎÇòÍ∏∞", date: new Date()}, 
      {id:2, isDone:false, content:"ÎÇÆÏû†ÏûêÍ∏∞", date: new Date()}, 
      ];
      let day =["Ïùº","Ïõî","Ìôî","Ïàò","Î™©","Í∏à","ÌÜ†"];
        onload=()=>{
            initData(mockData);

        }
    const initData = (printData)=>{
        let item = document.querySelector(".todos_wrapper");
        item.innerHTML="";
        for (let index = 0; index < printData.length; index++) {
            item.innerHTML+=`<div class="TodoItem">
                <input type="checkbox" onchange="onUpdate(this.id)" id=${printData[index].id}>
                <div class="content"></div>
                <div class="date"></div>
                <button class="button" onclick="todoDel(this)">ÏÇ≠Ï†ú</button>
            </div>`
        }
        document.querySelectorAll(".TodoItem").forEach((item,idx) => {
           if(printData[idx].isDone)item.querySelector("input").checked=true;
           item.querySelector(".content").innerText = printData[idx].content;
           let dateTime =printData[idx].date;
           item.querySelector(".date").innerText = dateTime.getFullYear()+"."+dateTime.getMonth()+"."+dateTime.getDay()+"."+(dateTime.getHours()<12?('Ïò§Ï†Ñ '+dateTime.getHours()):('Ïò§ÌõÑ '+(dateTime.getHours()-12)))+":"+dateTime.getMinutes()+":"+dateTime.getSeconds();
        });
    }


    </script>
    <div class="App">
        <div class="Header">
            <h3>Ïò§ÎäòÏùò Planüòä</h3>
            <h1 id="current_date">
                <script>
                   let date = new Date();
                   let year = date.getFullYear();
                   let month = date.getMonth() + 1;
                   let days = date.getDate();
                    document.getElementById("current_date").innerHTML = year + "-" + month + "-" + days+" "+day[date.getDay()]+"ÏöîÏùº";
                </script>
            </h1>       
        </div>
        <form>
            <div class="Editor">
                <input id="inputContent">
                <button>Ï∂îÍ∞Ä</button> 

            </div>
        </form>
    

    <div class="List">
        <h4></h4>
        <input type="text" id="keyword">
        <div class="todos_wrapper">
            <div class="TodoItem">
                <input type="checkbox" onchange="onUpdate(this.id)" id="0">
                <div class="content"></div>
                <div class="date"></div>
                <button class="button" onclick="todoDel(this)">ÏÇ≠Ï†ú</button>
            </div>
            <div class="TodoItem">
                <input type="checkbox" onchange="onUpdate(this.id)" id="1">
                <div class="content"></div>
                <div class="date"></div>
                <button class="button" onclick="todoDel(this)">ÏÇ≠Ï†ú</button>
            </div>
            <div class="TodoItem">
                <input type="checkbox" onchange="onUpdate(this.id)" id="2">
                <div class="content"></div>
                <div class="date"></div>
                <button class="button" onclick="todoDel(this)">ÏÇ≠Ï†ú</button>
            </div>
        </div>
    </div>
</div>
<script>
    let index=3;
    document.querySelector(".Editor > button").onclick =() =>{ 
        event.preventDefault(); //Ï†ÑÏÜ°Í∏∞Îä• ÎßâÏùå 
        let input = document.getElementById("inputContent").value;
        let item = {id:index++,isDone:false,content:input,date:new Date()};//{id:0, isDone:false, content:"React study", date: new Date()}
        mockData.push(item);
       initData(mockData); //Ìò∏Ï∂úÌïúÎã§.(Îã§Ïãú ÌôîÎ©¥ ÎûúÎçîÎßÅ) 
     }
     const onUpdate = (targetId)=>{
    mockData.forEach((item)=>{
        if(item.id===parseInt(targetId)){
            item.isDone = !item.isDone;
        }});
        initData(mockData); //Ìò∏Ï∂úÌïúÎã§.(Îã§Ïãú ÌôîÎ©¥ ÎûúÎçîÎßÅ)
    }
    
    const todoDel = (th)=>{ 
        //filter()Ìï®ÏàòÎ•º Ïù¥Ïö©Ìï¥ÏÑú ÏÇ≠Ï†úÌïòÎ†§Îäî ÎåÄÏÉÅÏù¥Ïô∏Ïùò todoÎßå Ï∂îÏ∂úÌï¥ÏÑú mockDataÏóê Îã¥Îì†Îã§.
      
        let id = th.parentNode.querySelector("input").getAttribute("id");
        mockData = mockData.filter(item => item.id!=id);
        th.parentElement.remove();
     initData(mockData); //Ìò∏Ï∂úÌïúÎã§.(Îã§Ïãú ÌôîÎ©¥ ÎûúÎçîÎßÅ) 
    }

    document.querySelector("#keyword").onkeyup = (e)=>{
        let searchedTodos = getFilterData(e.target.value);
        console.log(searchedTodos);
        initData(searchedTodos);
        }
        const getFilterData = (search) =>{
        if(search===""){
        return mockData;
        }
        return mockData.filter(data => data.content.includes(search));
    }
   


</script>
</body>
</html>